{% extends 'profileBase.html' %}

{% block title %}
Личный кабинет
{% endblock %}

{% block content %}
{% load static %}

<link rel="stylesheet" type='text/css' href='{% static "css/profile.css" %}'>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

<div class="container body-form">
    <div class="row tabs">
        <button tag="tablinks" class="nav-item to_profile" name="to_profile" onclick="openTab(event, 'Profile')">Личный кабинет</button>
        <button tag="tablinks" class="nav-item to_questions" name="to_questions" onclick="openTab(event, 'Survey')">Опрос</button>
        <button tag="tablinks" class="nav-item to_rec" name="to_rec" onclick="openTab(event, 'Recommend')">Рекомендации</button>
    </div>

    <!-- vvv Вкладка личного кабинета vvv -->
    <div id="Profile" class="tabcontent">
        <div class="row geninfo">
            <div class="geninfo_block">
                <div class="row part1">
                    <div class="col-md-12">
                        <p>{{ user.get_full_name }}</p>
                        <p>Электронная почта: {{ user.email }}</p> 
                    </div>
                </div>
                <div class="row part2">
                    <!-- vvv через класс формы heightNweight vvv -->
                    <div class="col-md-5">
                        <form method="post">
                            {% csrf_token %}
                            <div class="formHW">
                                <p>{{ formHW.height.label }} {{ formHW.height }} см</p> 
                                <p>{{ formHW.weight.label }} {{ formHW.weight }} кг</p>
                                <button hidden type="submit" class="submitHW" name='formHW_submit'>✓</button>
                            </div>
                        </form>
                    </div>
                    <div class="col-md-7">
                        <p>Учебное заведение: {{ user.university }}</p>
                        <p>Факультет: {{ user.faculty }}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row analysis">
            <div class="analysis_block">
                <p>Анализы</p>
                <div class="row analys1">
                    <div class="col-md-10 analysis_info">
                        <form method="post">
                            {% csrf_token %}
                            <p>Данные измерений</p>
                            {% if Analysis %}
                                <p>|</p>
                                {% for anal in Analysis %}
                                    {% if anal.type == "Данные измерений" %}
                                        <a href="#" tag="add_new_values" onclick="showModalWin('{{ anal.id }}')">{{ anal.time|date:"d.m" }}</a>
                                        <p>|</p>
                                        <div class="popup" id="popup{{ anal.id }}">
                                            <!-- Модалка для вывода параметров анализа -->
                                            {% if ParametersMeasure %}
                                                {% for parameter in ParametersMeasure %}
                                                    {% if anal == parameter.analysis %}
                                                        <p>{{ parameter.name }}: {{ parameter.result }} {{ parameter.units }}</p>
                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            <button type="submit" tag="add_new_parameters" name='add_new_parameters_toMeasure'>+</button>
                        </form>
                    </div>
                    <div class="col-md-10 analysis_info">
                        <form method="post">
                            {% csrf_token %}
                            <p>Общий Анализ Крови</p>
                            {% if Analysis %}
                            <p>|</p>
                                {% for anal in Analysis %}
                                    {% if anal.type == "Общий Анализ Крови" %}
                                        <a href="#" tag="add_new_values" onclick="showModalWin('{{ anal.id }}')">{{ anal.time|date:"d.m" }}</a>
                                        <p>|</p>
                                        <div class="popup" id="popup{{ anal.id }}">
                                            <!-- Модалка для вывода параметров анализа -->
                                            {% if ParametersOAK %}
                                                {% for parameter in ParametersOAK %}
                                                    {% if anal == parameter.analysis %}
                                                        <p>{{ parameter.name }}: {{ parameter.result }} </p>
                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            <button type="submit" tag="add_new_parameters" name='add_new_parameters_toOAK'>+</button>
                        </form>
                    </div>
                    <div class="col-md-10 analysis_info">
                        <form method="post">
                            {% csrf_token %}
                            <p>Данные кардиовизора</p>
                            {% if Analysis %}
                            <p>|</p>
                                {% for anal in Analysis %}
                                    {% if anal.type == "Данные кардиовизора" %}
                                        <a href="#" tag="add_new_values" onclick="showModalWin('{{ anal.id }}')">{{ anal.time|date:"d.m" }}</a>
                                        <p>|</p>
                                        <div class="popup" id="popup{{ anal.id }}">
                                            <!-- Модалка для вывода параметров анализа -->
                                            {% if ParametersCardio %}
                                                {% for parameter in ParametersCardio %}
                                                    {% if anal == parameter.analysis %}
                                                        <p>{{ parameter.name }}: {{ parameter.result }} </p>
                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            <button type="submit" tag="add_new_parameters" name='add_new_parameters_toCardio'>+</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- vvv Вкладка опроса vvv -->
    <div id="Survey" class="tabcontent" style="display: none;">
        <form method="post">
            {% csrf_token %}
            {% for block in Survey_Blocks %}
            <button type="submit" class="survey_block" name="block{{ block.id }}" >
                <p> Блок: {{ block.name }} </p>
            </button>
            {% endfor %}
        </form>
    </div>

    <!-- vvv Вкладка рекомендаций vvv -->
    <div id="Recommend" class="tabcontent" style="display: none;">
        Рекомендации
    </div>
</div>

{% endblock %}